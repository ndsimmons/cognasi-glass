---
// Shop Page - All Pieces
import { products, formatPrice } from '../data/products';
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/jpeg" href="/logo-cropped.jpg" />
		<link rel="shortcut icon" type="image/jpeg" href="/logo-cropped.jpg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Shop - Cognasi Glass Co.</title>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
	</head>
	<body>
		<!-- Navigation -->
		<nav class="navbar">
			<div class="container">
				<div class="nav-wrapper">
					<a href="/logo" class="logo">
						<img src="/logo-cropped.jpg" alt="Cognasi Glass Co." />
					</a>
			<ul class="nav-links">
				<li><a href="/">Home</a></li>
				<li><a href="/shop" class="active">Shop</a></li>
				<li><a href="/customers">Custom Work</a></li>
				<li><a href="/about">About Us</a></li>
				<li>
							<button class="cart-btn" aria-label="Shopping Cart" id="cart-toggle">
								<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<circle cx="9" cy="21" r="1"></circle>
									<circle cx="20" cy="21" r="1"></circle>
									<path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
								</svg>
								<span class="cart-count" id="cart-count">0</span>
							</button>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<!-- Shop Section -->
		<section class="shop">
			<div class="container">
				<h1 class="page-title">Our Collection</h1>
				<p class="page-subtitle">Handcrafted stained glass pieces, each one unique and made with love</p>
				
				<!-- Category Filter -->
				<div class="filter-container">
					<button class="filter-btn active" data-category="all">All</button>
					<button class="filter-btn" data-category="pieces">Pieces</button>
					<button class="filter-btn" data-category="glass-sheets">Glass Sheets</button>
					<button class="filter-btn" data-category="supplies">Supplies</button>
				</div>

				<div class="gallery-grid">
					{products.map(product => (
						<div class="gallery-item" data-category={product.category}>
							<div class="item-image" data-image={product.image} data-name={product.name}>
								<img src={product.image} alt={product.description} />
								<div class="image-overlay-zoom">
									<svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
										<circle cx="11" cy="11" r="8"></circle>
										<path d="m21 21-4.35-4.35"></path>
										<line x1="11" y1="8" x2="11" y2="14"></line>
										<line x1="8" y1="11" x2="14" y2="11"></line>
									</svg>
								</div>
							</div>
							<h3>{product.name}</h3>
							<p class="price">{formatPrice(product.price)}</p>
							<div class="item-actions">
								<button 
									class="btn btn-primary add-to-cart-btn" 
									data-product-id={product.id}
								>
									Add to Cart
								</button>
								<button 
									class="btn btn-secondary buy-now-btn" 
									data-product-id={product.id}
								>
									Buy Now
								</button>
							</div>
						</div>
					))}
				</div>
			</div>
		</section>

		<!-- Cart Sidebar -->
		<div class="cart-sidebar" id="cart-sidebar">
			<div class="cart-overlay" id="cart-overlay"></div>
			<div class="cart-content">
				<div class="cart-header">
					<h2>Shopping Cart</h2>
					<button class="cart-close" id="cart-close" aria-label="Close cart">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<line x1="18" y1="6" x2="6" y2="18"></line>
							<line x1="6" y1="6" x2="18" y2="18"></line>
						</svg>
					</button>
				</div>
				<div class="cart-items" id="cart-items">
					<!-- Cart items will be dynamically inserted here -->
				</div>
				<div class="cart-footer">
					<div class="cart-total">
						<span>Total:</span>
						<span id="cart-total">$0.00</span>
					</div>
					<button class="btn btn-primary btn-block" id="checkout-btn">
						Checkout
					</button>
				</div>
			</div>
		</div>

		<!-- Image Modal -->
		<div class="image-modal" id="image-modal">
			<div class="modal-overlay" id="modal-overlay"></div>
			<div class="modal-content">
				<button class="modal-close" id="modal-close" aria-label="Close modal">
					<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
						<line x1="18" y1="6" x2="6" y2="18"></line>
						<line x1="6" y1="6" x2="18" y2="18"></line>
					</svg>
				</button>
				<img id="modal-image" src="" alt="" />
				<div class="modal-title" id="modal-title"></div>
			</div>
		</div>

		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			:root {
				--primary-color: #8B4513;
				--secondary-color: #D4A574;
				--accent-color: #CD853F;
				--text-dark: #2C1810;
				--text-light: #6B5D54;
				--bg-light: #FAF9F7;
				--white: #FFFFFF;
			}

			body {
				font-family: 'Montserrat', sans-serif;
				color: var(--text-dark);
				background-color: var(--bg-light);
				line-height: 1.6;
			}

			h1, h2, h3 {
				font-family: 'Playfair Display', serif;
			}

			.container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 0 2rem;
			}

			/* Navigation */
			.navbar {
				background: var(--white);
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
				position: sticky;
				top: 0;
				z-index: 100;
			}

			.nav-wrapper {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.5rem 0;
			}

			.logo img {
				height: 60px;
				display: block;
			}

			.nav-links {
				display: flex;
				list-style: none;
				gap: 2.5rem;
				align-items: center;
			}

			.nav-links a {
				text-decoration: none;
				color: var(--text-dark);
				font-weight: 500;
				font-size: 0.95rem;
				letter-spacing: 0.5px;
				transition: color 0.3s ease;
				position: relative;
			}

			.nav-links a:hover,
			.nav-links a.active {
				color: var(--primary-color);
			}

			.nav-links a.active::after {
				content: '';
				position: absolute;
				bottom: -5px;
				left: 0;
				right: 0;
				height: 2px;
				background: var(--primary-color);
			}

			.search-btn {
				background: none;
				border: none;
				color: var(--text-dark);
				cursor: pointer;
				padding: 0.5rem;
				display: flex;
				align-items: center;
				transition: color 0.3s ease;
			}

			.search-btn:hover {
				color: var(--primary-color);
			}

			.cart-btn {
				background: none;
				border: none;
				color: var(--text-dark);
				cursor: pointer;
				padding: 0.5rem;
				display: flex;
				align-items: center;
				transition: color 0.3s ease;
				position: relative;
			}

			.cart-btn:hover {
				color: var(--primary-color);
			}

			.cart-count {
				position: absolute;
				top: 0;
				right: 0;
				background: var(--primary-color);
				color: var(--white);
				font-size: 0.7rem;
				font-weight: 600;
				padding: 0.15rem 0.4rem;
				border-radius: 10px;
				min-width: 18px;
				text-align: center;
			}

			.cart-count:empty {
				display: none;
			}

			/* Shop Section */
			.shop {
				padding: 4rem 0 6rem;
			}

			.page-title {
				text-align: center;
				font-size: 3.5rem;
				margin-bottom: 1rem;
				color: var(--text-dark);
			}

			.page-subtitle {
				text-align: center;
				font-size: 1.2rem;
				color: var(--text-light);
				margin-bottom: 2rem;
			}

			/* Category Filter */
			.filter-container {
				display: flex;
				justify-content: center;
				gap: 1rem;
				margin-bottom: 3rem;
				flex-wrap: wrap;
			}

			.filter-btn {
				padding: 0.75rem 2rem;
				border: 2px solid var(--primary-color);
				background: var(--white);
				color: var(--primary-color);
				font-size: 1rem;
				font-weight: 600;
				border-radius: 50px;
				cursor: pointer;
				transition: all 0.3s ease;
				text-transform: capitalize;
			}

			.filter-btn:hover {
				background: var(--bg-light);
				transform: translateY(-2px);
			}

			.filter-btn.active {
				background: var(--primary-color);
				color: var(--white);
			}

			.gallery-grid {
				display: grid;
				grid-template-columns: repeat(3, 1fr);
				gap: 2.5rem;
			}

			.gallery-item {
				transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.3s ease;
			}

			.gallery-item.hidden {
				display: none;
			}

			.gallery-item {
				background: var(--white);
				border-radius: 8px;
				overflow: hidden;
				box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
				cursor: pointer;
			}

			.gallery-item:hover {
				transform: translateY(-8px);
				box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
			}

			.item-image {
				width: 100%;
				height: 300px;
				overflow: hidden;
				position: relative;
				cursor: pointer;
			}

			.item-image img {
				width: 100%;
				height: 100%;
				object-fit: cover;
				transition: transform 0.5s ease;
			}

			.gallery-item:hover .item-image img {
				transform: scale(1.1);
			}

			.image-overlay-zoom {
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(0, 0, 0, 0.5);
				display: flex;
				align-items: center;
				justify-content: center;
				opacity: 0;
				transition: opacity 0.3s ease;
			}

			.item-image:hover .image-overlay-zoom {
				opacity: 1;
			}

			.gallery-item h3 {
				padding: 1.5rem 1.5rem 0.5rem;
				font-size: 1.4rem;
				color: var(--text-dark);
			}

			.price {
				padding: 0 1.5rem 0.5rem;
				font-size: 1.2rem;
				font-weight: 600;
				color: var(--primary-color);
			}

			.item-actions {
				padding: 0 1.5rem 1.5rem;
				display: flex;
				gap: 0.75rem;
			}

			.btn {
				padding: 0.75rem 1.5rem;
				border: none;
				border-radius: 4px;
				font-size: 0.95rem;
				font-weight: 600;
				cursor: pointer;
				transition: all 0.3s ease;
				flex: 1;
			}

			.btn-primary {
				background: var(--primary-color);
				color: var(--white);
			}

			.btn-primary:hover {
				background: var(--text-dark);
				transform: translateY(-2px);
			}

			.btn-secondary {
				background: var(--white);
				color: var(--primary-color);
				border: 2px solid var(--primary-color);
			}

			.btn-secondary:hover {
				background: var(--primary-color);
				color: var(--white);
			}

			.btn-block {
				width: 100%;
			}

			/* Cart Sidebar */
			.cart-sidebar {
				position: fixed;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				z-index: 1000;
				pointer-events: none;
			}

			.cart-sidebar.open {
				pointer-events: all;
			}

			.cart-overlay {
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(0, 0, 0, 0.5);
				opacity: 0;
				transition: opacity 0.3s ease;
			}

			.cart-sidebar.open .cart-overlay {
				opacity: 1;
			}

			.cart-content {
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				width: 400px;
				max-width: 90vw;
				background: var(--white);
				box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
				transform: translateX(100%);
				transition: transform 0.3s ease;
				display: flex;
				flex-direction: column;
			}

			.cart-sidebar.open .cart-content {
				transform: translateX(0);
			}

			.cart-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 1.5rem;
				border-bottom: 1px solid #e0e0e0;
			}

			.cart-header h2 {
				font-size: 1.5rem;
				margin: 0;
			}

			.cart-close {
				background: none;
				border: none;
				color: var(--text-dark);
				cursor: pointer;
				padding: 0.5rem;
				display: flex;
				align-items: center;
				transition: color 0.3s ease;
			}

			.cart-close:hover {
				color: var(--primary-color);
			}

			.cart-items {
				flex: 1;
				overflow-y: auto;
				padding: 1.5rem;
			}

			.cart-item {
				display: flex;
				align-items: center;
				gap: 1rem;
				margin-bottom: 1rem;
				padding-bottom: 1rem;
				border-bottom: 1px solid #e0e0e0;
			}

			.cart-item:last-child {
				border-bottom: none;
			}

			.cart-item-image {
				width: 50px;
				height: 50px;
				object-fit: cover;
				border-radius: 4px;
				flex-shrink: 0;
			}

			.cart-item-info {
				flex: 1;
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
				min-width: 0;
			}

			.cart-item-name {
				font-weight: 600;
				color: var(--text-dark);
				font-size: 0.95rem;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}

			.cart-item-price {
				color: var(--primary-color);
				font-weight: 600;
				font-size: 0.9rem;
			}

			.cart-item-quantity {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				flex-shrink: 0;
			}

			.quantity-btn {
				background: var(--bg-light);
				border: 1px solid #e0e0e0;
				color: var(--text-dark);
				width: 24px;
				height: 24px;
				border-radius: 4px;
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 0.9rem;
				transition: all 0.2s ease;
			}

			.quantity-btn:hover {
				background: var(--primary-color);
				color: var(--white);
				border-color: var(--primary-color);
			}

			.quantity-value {
				min-width: 24px;
				text-align: center;
				font-weight: 600;
				font-size: 0.9rem;
			}

			.cart-item-remove {
				background: none;
				border: none;
				color: var(--text-light);
				cursor: pointer;
				padding: 0.25rem;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: color 0.2s ease;
				flex-shrink: 0;
			}

			.cart-item-remove:hover {
				color: #dc3545;
			}

			.cart-empty {
				text-align: center;
				padding: 3rem 1rem;
				color: var(--text-light);
			}

			.cart-footer {
				padding: 1.5rem;
				border-top: 1px solid #e0e0e0;
			}

			.cart-total {
				display: flex;
				justify-content: space-between;
				font-size: 1.3rem;
				font-weight: 700;
				margin-bottom: 1rem;
				color: var(--text-dark);
			}

			/* Image Modal */
			.image-modal {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				z-index: 2000;
				display: none;
				align-items: center;
				justify-content: center;
			}

			.image-modal.open {
				display: flex;
			}

			.modal-overlay {
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(0, 0, 0, 0.9);
			}

			.modal-content {
				position: relative;
				z-index: 2001;
				max-width: 90vw;
				max-height: 90vh;
				display: flex;
				flex-direction: column;
				align-items: center;
			}

			.modal-close {
				position: absolute;
				top: -50px;
				right: 0;
				background: none;
				border: none;
				color: white;
				cursor: pointer;
				padding: 0.5rem;
				transition: opacity 0.3s ease;
			}

			.modal-close:hover {
				opacity: 0.7;
			}

			#modal-image {
				max-width: 100%;
				max-height: 80vh;
				object-fit: contain;
				border-radius: 8px;
			}

			.modal-title {
				color: white;
				font-size: 1.5rem;
				font-weight: 600;
				margin-top: 1.5rem;
				text-align: center;
			}

			/* Responsive Design */
			@media (max-width: 768px) {
				.nav-links {
					gap: 1.5rem;
				}

				.page-title {
					font-size: 2.5rem;
				}

				.page-subtitle {
					font-size: 1rem;
				}

				.gallery-grid {
					grid-template-columns: 1fr;
					gap: 2rem;
				}
			}

		@media (max-width: 480px) {
			.container {
				padding: 0 1rem;
			}

			.nav-links {
				gap: 0.75rem;
				font-size: 0.8rem;
			}

			.logo img {
				height: 50px;
			}

			.page-title {
				font-size: 2rem;
			}
		}
		</style>

		<script>
			// Product data (imported from products.ts at build time)
			const products = [
				{
					id: 'glass-circle-art',
					name: 'Glass Circle Art',
					price: 15000,
					image: '/donut-piece.jpg',
					description: 'Handmade stained glass circle piece',
					category: 'pieces'
				},
				{
					id: 'stained-glass-creation',
					name: 'Stained Glass Creation',
					price: 18000,
					image: '/IMG_4033_cropped.jpeg',
					description: 'Handmade stained glass piece',
					category: 'pieces'
				},
				{
					id: 'glass-art-piece',
					name: 'Glass Art Piece',
					price: 22000,
					image: '/IMG_4115.JPG',
					description: 'Handmade stained glass piece',
					category: 'pieces'
				},
				{
					id: 'artistic-glass-work',
					name: 'Artistic Glass Work',
					price: 19500,
					image: '/IMG_4447.jpg',
					description: 'Handmade stained glass piece',
					category: 'pieces'
				},
				{
					id: 'glass-masterpiece',
					name: 'Glass Masterpiece',
					price: 25000,
					image: '/IMG_7793.jpg',
					description: 'Handmade stained glass piece',
					category: 'pieces'
				},
				{
					id: 'glass-rose',
					name: 'Glass Rose',
					price: 17500,
					image: '/IMG_8510_cropped.jpeg',
					description: 'Handmade stained glass rose',
					category: 'pieces'
				}
			];

			// Category Filter
			function filterProducts(category) {
				const items = document.querySelectorAll('.gallery-item');
				const filterBtns = document.querySelectorAll('.filter-btn');
				
				// Update active button
				filterBtns.forEach(btn => btn.classList.remove('active'));
				document.querySelector(`[data-category="${category}"]`).classList.add('active');
				
				// Show/hide items
				items.forEach(item => {
					if (category === 'all' || item.dataset.category === category) {
						item.classList.remove('hidden');
					} else {
						item.classList.add('hidden');
					}
				});
			}

			// Cart state
			let cart = [];

			// Load cart from localStorage on page load
			function loadCart() {
				const savedCart = localStorage.getItem('cart');
				if (savedCart) {
					cart = JSON.parse(savedCart);
					updateCartUI();
				}
			}

			// Save cart to localStorage
			function saveCart() {
				localStorage.setItem('cart', JSON.stringify(cart));
				updateCartUI();
			}

			// Add item to cart
			function addToCart(productId) {
				const product = products.find(p => p.id === productId);
				if (!product) return;

				const existingItem = cart.find(item => item.id === productId);
				if (existingItem) {
					existingItem.quantity += 1;
				} else {
					cart.push({ ...product, quantity: 1 });
				}
				saveCart();
				openCart();
			}

			// Remove item from cart
			function removeFromCart(productId) {
				cart = cart.filter(item => item.id !== productId);
				saveCart();
			}

			// Update item quantity
			function updateQuantity(productId, newQuantity) {
				const item = cart.find(item => item.id === productId);
				if (item) {
					if (newQuantity <= 0) {
						removeFromCart(productId);
					} else {
						item.quantity = newQuantity;
						saveCart();
					}
				}
			}

			// Calculate cart total
			function getCartTotal() {
				return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
			}

			// Format price
			function formatPrice(priceInCents) {
				return `$${(priceInCents / 100).toFixed(2)}`;
			}

			// Update cart UI
			function updateCartUI() {
				// Update cart count
				const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
				const cartCountEl = document.getElementById('cart-count');
				if (cartCountEl) {
					cartCountEl.textContent = cartCount > 0 ? cartCount : '';
				}

				// Update cart items
				const cartItemsEl = document.getElementById('cart-items');
				if (cartItemsEl) {
					if (cart.length === 0) {
						cartItemsEl.innerHTML = '<div class="cart-empty">Your cart is empty</div>';
					} else {
						cartItemsEl.innerHTML = cart.map(item => {
							const showQuantity = item.category === 'supplies' || item.category === 'glass-sheets';
							const quantityControls = showQuantity ? `
								<div class="cart-item-quantity">
									<button class="quantity-btn" data-action="decrease" data-product-id="${item.id}">-</button>
									<span class="quantity-value">${item.quantity}</span>
									<button class="quantity-btn" data-action="increase" data-product-id="${item.id}">+</button>
								</div>
							` : '';
							
							return `
								<div class="cart-item">
									<img src="${item.image}" alt="${item.name}" class="cart-item-image" />
									<div class="cart-item-info">
										<div class="cart-item-name">${item.name}</div>
										<div class="cart-item-price">${formatPrice(item.price)}</div>
									</div>
									${quantityControls}
									<button class="cart-item-remove" data-product-id="${item.id}" aria-label="Remove ${item.name}">
										<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<line x1="18" y1="6" x2="6" y2="18"></line>
											<line x1="6" y1="6" x2="18" y2="18"></line>
										</svg>
									</button>
								</div>
							`;
						}).join('');
					}
				}

				// Update cart total
				const cartTotalEl = document.getElementById('cart-total');
				if (cartTotalEl) {
					cartTotalEl.textContent = formatPrice(getCartTotal());
				}
			}

			// Open cart sidebar
			function openCart() {
				const cartSidebar = document.getElementById('cart-sidebar');
				if (cartSidebar) {
					cartSidebar.classList.add('open');
					document.body.style.overflow = 'hidden';
				}
			}

			// Close cart sidebar
			function closeCart() {
				const cartSidebar = document.getElementById('cart-sidebar');
				if (cartSidebar) {
					cartSidebar.classList.remove('open');
					document.body.style.overflow = '';
				}
			}

			// Checkout with Stripe
			async function checkout(items = null) {
				try {
					const checkoutItems = items || cart;
					if (checkoutItems.length === 0) {
						alert('Your cart is empty');
						return;
					}

					const response = await fetch('/api/create-checkout-session', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
						},
						body: JSON.stringify({ items: checkoutItems }),
					});

					const { url } = await response.json();
					window.location.href = url;
				} catch (error) {
					console.error('Checkout error:', error);
					alert('Something went wrong. Please try again.');
				}
			}

			// Image Modal Functions
			function openImageModal(imageSrc, imageName) {
				const modal = document.getElementById('image-modal');
				const modalImage = document.getElementById('modal-image');
				const modalTitle = document.getElementById('modal-title');
				
				if (modal && modalImage && modalTitle) {
					modalImage.src = imageSrc;
					modalImage.alt = imageName;
					modalTitle.textContent = imageName;
					modal.classList.add('open');
					document.body.style.overflow = 'hidden';
				}
			}

			function closeImageModal() {
				const modal = document.getElementById('image-modal');
				if (modal) {
					modal.classList.remove('open');
					document.body.style.overflow = '';
				}
			}

			// Event listeners
			document.addEventListener('DOMContentLoaded', () => {
				loadCart();

				// Image click handlers
				document.querySelectorAll('.item-image').forEach(imageDiv => {
					imageDiv.addEventListener('click', (e) => {
						const imageSrc = imageDiv.dataset.image;
						const imageName = imageDiv.dataset.name;
						openImageModal(imageSrc, imageName);
					});
				});

				// Modal close handlers
				const modalClose = document.getElementById('modal-close');
				if (modalClose) {
					modalClose.addEventListener('click', closeImageModal);
				}

				const modalOverlay = document.getElementById('modal-overlay');
				if (modalOverlay) {
					modalOverlay.addEventListener('click', closeImageModal);
				}

				// ESC key to close modal
				document.addEventListener('keydown', (e) => {
					if (e.key === 'Escape') {
						closeImageModal();
					}
				});

				// Category filter buttons
				document.querySelectorAll('.filter-btn').forEach(btn => {
					btn.addEventListener('click', (e) => {
						const category = e.target.dataset.category;
						filterProducts(category);
					});
				});

				// Add to cart buttons
				document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
					btn.addEventListener('click', (e) => {
						const productId = e.target.dataset.productId;
						addToCart(productId);
					});
				});

				// Buy now buttons
				document.querySelectorAll('.buy-now-btn').forEach(btn => {
					btn.addEventListener('click', async (e) => {
						const productId = e.target.dataset.productId;
						const product = products.find(p => p.id === productId);
						if (product) {
							await checkout([{ ...product, quantity: 1 }]);
						}
					});
				});

				// Cart toggle button
				const cartToggle = document.getElementById('cart-toggle');
				if (cartToggle) {
					cartToggle.addEventListener('click', openCart);
				}

				// Cart close button
				const cartClose = document.getElementById('cart-close');
				if (cartClose) {
					cartClose.addEventListener('click', closeCart);
				}

				// Cart overlay
				const cartOverlay = document.getElementById('cart-overlay');
				if (cartOverlay) {
					cartOverlay.addEventListener('click', closeCart);
				}

				// Cart item actions (using event delegation)
				const cartItems = document.getElementById('cart-items');
				if (cartItems) {
					cartItems.addEventListener('click', (e) => {
						const target = e.target;
						
						// Quantity buttons
						if (target.classList.contains('quantity-btn')) {
							const productId = target.dataset.productId;
							const action = target.dataset.action;
							const item = cart.find(i => i.id === productId);
							
							if (item) {
								if (action === 'increase') {
									updateQuantity(productId, item.quantity + 1);
								} else if (action === 'decrease') {
									updateQuantity(productId, item.quantity - 1);
								}
							}
						}
						
						// Remove button
						if (target.classList.contains('cart-item-remove')) {
							const productId = target.dataset.productId;
							removeFromCart(productId);
						}
					});
				}

				// Checkout button
				const checkoutBtn = document.getElementById('checkout-btn');
				if (checkoutBtn) {
					checkoutBtn.addEventListener('click', () => checkout());
				}
			});
		</script>
	</body>
</html>
